# El Profesor HernÃ¡n - E-commerce Platform

## DescripciÃ³n del Proyecto

Plataforma de e-commerce especializada en cursos de inglÃ©s desarrollada en PHP con arquitectura MVC. El sistema permite la gestiÃ³n completa de cursos, usuarios, pagos y contenido educativo.

## ğŸ—ï¸ Arquitectura del Proyecto

### Estructura de Directorios

\`\`\`
E-commerce/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ Database.php                 # ConfiguraciÃ³n de base de datos
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ AdminController.php          # Controlador administrativo
â”‚   â”œâ”€â”€ AuthController.php           # AutenticaciÃ³n y autorizaciÃ³n
â”‚   â”œâ”€â”€ CartController.php           # GestiÃ³n del carrito de compras
â”‚   â”œâ”€â”€ PaymentController.php        # Procesamiento de pagos
â”‚   â”œâ”€â”€ PlaylistController.php       # GestiÃ³n de cursos/playlists
â”‚   â””â”€â”€ VideoController.php          # GestiÃ³n de videos
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ Order.php                    # Modelo de pedidos
â”‚   â”œâ”€â”€ Playlist.php                 # Modelo de cursos
â”‚   â”œâ”€â”€ User.php                     # Modelo de usuarios
â”‚   â”œâ”€â”€ UserCourse.php               # RelaciÃ³n usuario-curso
â”‚   â””â”€â”€ Video.php                    # Modelo de videos
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ admin/                       # Vistas administrativas
â”‚   â”‚   â”œâ”€â”€ courses.php
â”‚   â”‚   â”œâ”€â”€ dashboard.php
â”‚   â”‚   â”œâ”€â”€ edit_playlist.php
â”‚   â”‚   â”œâ”€â”€ orders.php
â”‚   â”‚   â”œâ”€â”€ settings.php
â”‚   â”‚   â”œâ”€â”€ sidebar.php
â”‚   â”‚   â”œâ”€â”€ upload_video.php
â”‚   â”‚   â””â”€â”€ users.php
â”‚   â””â”€â”€ client/                      # Vistas del cliente
â”‚       â”œâ”€â”€ all-courses.php
â”‚       â”œâ”€â”€ cart.php
â”‚       â”œâ”€â”€ checkout.php
â”‚       â”œâ”€â”€ course-detail.php
â”‚       â”œâ”€â”€ home.php
â”‚       â”œâ”€â”€ order-confirmation.php
â”‚       â””â”€â”€ purchase-history.php
â”œâ”€â”€ helpers/
â”‚   â”œâ”€â”€ SecurityHelper.php           # Funciones de seguridad
â”‚   â”œâ”€â”€ StripeHelper.php             # IntegraciÃ³n con Stripe
â”‚   â””â”€â”€ ValidationHelper.php        # Validaciones
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ AuthMiddleware.php           # Middleware de autenticaciÃ³n
â”œâ”€â”€ includes/
â”‚   â”œâ”€â”€ footer.php                   # Footer global
â”‚   â””â”€â”€ header.php                   # Header global
â”œâ”€â”€ public/
â”‚   â””â”€â”€ css/
â”‚       â”œâ”€â”€ cart-improvements.css
â”‚       â”œâ”€â”€ checkout-improvements.css
â”‚       â””â”€â”€ styles.css
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ create-sample-data.sql       # Script de datos de prueba
â”œâ”€â”€ index.php                        # PÃ¡gina principal
â”œâ”€â”€ login.php                        # PÃ¡gina de login
â”œâ”€â”€ signup.php                       # PÃ¡gina de registro
â”œâ”€â”€ logout.php                       # Logout
â””â”€â”€ google-login.php                 # Login con Google
\`\`\`

## ğŸ› ï¸ TecnologÃ­as Utilizadas

### Backend
- **PHP 8.0+**: Lenguaje principal del servidor
- **MySQL 8.0+**: Base de datos relacional
- **PDO**: Capa de abstracciÃ³n de base de datos
- **Sessions**: Manejo de sesiones de usuario

### Frontend
- **HTML5**: Estructura semÃ¡ntica
- **CSS3**: Estilos con variables CSS y Flexbox/Grid
- **JavaScript (Vanilla)**: Interactividad del cliente
- **Font Awesome 6.0**: IconografÃ­a

### Integraciones
- **Stripe API**: Procesamiento de pagos
- **Google OAuth**: AutenticaciÃ³n social
- **cURL**: ComunicaciÃ³n HTTP

### Herramientas de Desarrollo
- **XAMPP**: Entorno de desarrollo local
- **phpMyAdmin**: AdministraciÃ³n de base de datos
- **Git**: Control de versiones

## ğŸš€ ConfiguraciÃ³n del Entorno de Desarrollo

### Prerrequisitos
- XAMPP 8.0+ o similar (Apache + PHP + MySQL)
- Composer (opcional, para dependencias futuras)
- Git
- Navegador web moderno

### InstalaciÃ³n

1. **Clonar el repositorio**
   \`\`\`bash
   git clone [URL_DEL_REPOSITORIO]
   cd E-commerce
   \`\`\`

2. **Configurar XAMPP**
   - Iniciar Apache y MySQL
   - Colocar el proyecto en `htdocs/E-commerce/`

3. **Configurar la base de datos**
   \`\`\`sql
   CREATE DATABASE ecommerce_hernan;
   USE ecommerce_hernan;
   \`\`\`

4. **Ejecutar scripts de inicializaciÃ³n**
   \`\`\`bash
   # Ejecutar desde phpMyAdmin o lÃ­nea de comandos
   mysql -u root -p ecommerce_hernan < scripts/create-sample-data.sql
   \`\`\`

5. **Configurar variables de entorno**
   \`\`\`php
   // En config/Database.php
   private $host = "localhost";
   private $db_name = "ecommerce_hernan";
   private $username = "root";
   private $password = "";
   \`\`\`

6. **Configurar Stripe (opcional)**
   \`\`\`php
   // En helpers/StripeHelper.php
   private $publishable_key = "pk_test_...";
   private $secret_key = "sk_test_...";
   \`\`\`

### Acceso a la AplicaciÃ³n
- **URL Principal**: `http://localhost/E-commerce/`
- **Panel Admin**: `http://localhost/E-commerce/views/admin/dashboard.php`
- **Login**: `http://localhost/E-commerce/login.php`

## ğŸ“Š Estructura de Base de Datos

### Tablas Principales

#### users
\`\`\`sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('user', 'admin') DEFAULT 'user',
    google_id VARCHAR(255) NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP NULL
);
\`\`\`

#### playlists (cursos)
\`\`\`sql
CREATE TABLE playlists (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) DEFAULT 0.00,
    level VARCHAR(10),
    cover_image VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
\`\`\`

#### orders
\`\`\`sql
CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    total_amount DECIMAL(10,2) NOT NULL,
    currency VARCHAR(3) DEFAULT 'USD',
    status ENUM('pending', 'completed', 'failed') DEFAULT 'pending',
    stripe_payment_intent_id VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
\`\`\`

#### user_courses
\`\`\`sql
CREATE TABLE user_courses (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    playlist_id INT NOT NULL,
    access_granted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (playlist_id) REFERENCES playlists(id),
    UNIQUE KEY unique_user_course (user_id, playlist_id)
);
\`\`\`

## ğŸ”§ Funcionalidades Principales

### Sistema de AutenticaciÃ³n
- **Registro/Login tradicional**: Email y contraseÃ±a
- **Login con Google**: OAuth 2.0
- **GestiÃ³n de sesiones**: Segura con tokens
- **Roles de usuario**: Admin y Usuario regular

### GestiÃ³n de Cursos
- **CRUD completo**: Crear, leer, actualizar, eliminar
- **Subida de videos**: GestiÃ³n de contenido multimedia
- **CategorizaciÃ³n**: Por niveles (A1, A2, B1, B2, C1, C2)
- **ImÃ¡genes de portada**: Upload y gestiÃ³n

### Sistema de Carrito
- **Agregar/Eliminar**: GestiÃ³n dinÃ¡mica de items
- **Persistencia**: Mantiene estado entre sesiones
- **CÃ³digos promocionales**: Sistema de descuentos
- **CÃ¡lculo de totales**: Subtotal, impuestos, descuentos

### Procesamiento de Pagos
- **IntegraciÃ³n Stripe**: Pagos seguros con tarjeta
- **Webhooks**: ConfirmaciÃ³n automÃ¡tica de pagos
- **GestiÃ³n de pedidos**: Seguimiento completo
- **Acceso automÃ¡tico**: AsignaciÃ³n de cursos post-pago

### Panel Administrativo
- **Dashboard**: EstadÃ­sticas y mÃ©tricas
- **GestiÃ³n de usuarios**: CRUD y permisos
- **GestiÃ³n de cursos**: Contenido y precios
- **GestiÃ³n de pedidos**: Estados y seguimiento

## ğŸ”’ Seguridad Implementada

### AutenticaciÃ³n y AutorizaciÃ³n
- **Hash de contraseÃ±as**: password_hash() con BCRYPT
- **Tokens CSRF**: ProtecciÃ³n contra ataques CSRF
- **ValidaciÃ³n de sesiones**: VerificaciÃ³n en cada request
- **Middleware de autenticaciÃ³n**: Control de acceso

### ValidaciÃ³n de Datos
- **SanitizaciÃ³n**: htmlspecialchars() en todas las salidas
- **ValidaciÃ³n de entrada**: Filtros y validaciones
- **Prepared statements**: PrevenciÃ³n de SQL injection
- **ValidaciÃ³n de archivos**: Tipos y tamaÃ±os permitidos

### ComunicaciÃ³n Segura
- **HTTPS recomendado**: Para producciÃ³n
- **Headers de seguridad**: CSP, HSTS, etc.
- **ValidaciÃ³n de origen**: CORS y referrer

## ğŸ§ª Testing y Debugging

### Pruebas Manuales
1. **Registro de usuario**
   - Crear cuenta nueva
   - Validar email Ãºnico
   - Verificar hash de contraseÃ±a

2. **Funcionalidad del carrito**
   - Agregar cursos
   - Verificar persistencia
   - Calcular totales

3. **Proceso de pago**
   - Checkout completo
   - ConfirmaciÃ³n de pago
   - AsignaciÃ³n de acceso

4. **Panel administrativo**
   - Crear/editar cursos
   - Gestionar usuarios
   - Ver estadÃ­sticas

### Debugging
- **Error logging**: error_log() en puntos crÃ­ticos
- **Console logging**: JavaScript para frontend
- **Database queries**: Log de consultas SQL
- **Session debugging**: Verificar variables de sesiÃ³n

## ğŸš€ Despliegue en ProducciÃ³n

### ConfiguraciÃ³n del Servidor
1. **Servidor web**: Apache/Nginx con PHP 8.0+
2. **Base de datos**: MySQL 8.0+ o MariaDB
3. **SSL/TLS**: Certificado vÃ¡lido para HTTPS
4. **PHP extensions**: PDO, cURL, GD, OpenSSL

### Variables de Entorno
\`\`\`php
// ConfiguraciÃ³n de producciÃ³n
define('DB_HOST', 'your-db-host');
define('DB_NAME', 'your-db-name');
define('DB_USER', 'your-db-user');
define('DB_PASS', 'your-db-password');
define('STRIPE_SECRET_KEY', 'sk_live_...');
define('STRIPE_PUBLISHABLE_KEY', 'pk_live_...');
\`\`\`

### Optimizaciones
- **CompresiÃ³n GZIP**: Reducir tamaÃ±o de respuestas
- **Cache de archivos**: Headers de cache apropiados
- **MinificaciÃ³n**: CSS y JavaScript
- **CDN**: Para archivos estÃ¡ticos

## ğŸ“ˆ MÃ©tricas y Monitoreo

### KPIs del Sistema
- **Usuarios registrados**: Total y por perÃ­odo
- **Cursos vendidos**: Ingresos y conversiÃ³n
- **Tasa de abandono**: Carrito y checkout
- **Tiempo de respuesta**: Performance del servidor

### Logs Importantes
- **Errores de aplicaciÃ³n**: PHP error log
- **Transacciones**: Log de pagos y pedidos
- **Acceso de usuarios**: Login/logout events
- **Actividad admin**: Cambios en el sistema

## ğŸ”„ Mantenimiento y Actualizaciones

### Tareas Regulares
- **Backup de base de datos**: Diario automÃ¡tico
- **Limpieza de logs**: RotaciÃ³n semanal
- **ActualizaciÃ³n de dependencias**: Mensual
- **RevisiÃ³n de seguridad**: Trimestral

### Monitoreo de Salud
- **Uptime**: Disponibilidad del servicio
- **Performance**: Tiempo de respuesta
- **Errores**: Rate de errores 4xx/5xx
- **Capacidad**: Uso de recursos del servidor

## ğŸ¤ ContribuciÃ³n y Desarrollo

### EstÃ¡ndares de CÃ³digo
- **PSR-12**: EstÃ¡ndar de codificaciÃ³n PHP
- **Comentarios**: DocumentaciÃ³n en cÃ³digo
- **Naming conventions**: CamelCase para clases, snake_case para variables
- **Error handling**: Try-catch apropiado

### Flujo de Desarrollo
1. **Feature branch**: Crear rama para nueva funcionalidad
2. **Testing**: Pruebas locales completas
3. **Code review**: RevisiÃ³n de cÃ³digo
4. **Merge**: IntegraciÃ³n a rama principal
5. **Deploy**: Despliegue a producciÃ³n

## ğŸ“ Soporte y Contacto

### DocumentaciÃ³n TÃ©cnica
- **API Reference**: DocumentaciÃ³n de endpoints
- **Database Schema**: Diagrama ER actualizado
- **Deployment Guide**: GuÃ­a de despliegue detallada

### ResoluciÃ³n de Problemas Comunes
- **Carrito vacÃ­o**: Verificar sesiones PHP
- **Pagos fallidos**: Revisar configuraciÃ³n Stripe
- **Login issues**: Validar hash de contraseÃ±as
- **Performance**: Optimizar consultas SQL

---

*DocumentaciÃ³n actualizada: Enero 2024*
*VersiÃ³n del proyecto: 1.0.0*
